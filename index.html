<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>QR ile Şifreleme</title>
<script src="https://unpkg.com/html5-qrcode"></script>
</head>
<body>
<h1>QR Kod ile Şifreleme</h1>

<div id="reader" style="width:300px;"></div>
<p>Şifreli Kod: <span id="sifreliKod">Bekleniyor...</span></p>

<script>
// Şifreleme algoritması
const islemler = [-8, 7, -5, 3, -2, 5];

function sifrele(kod) {
    let sonuc = "";
    for (let i = 0; i < kod.length; i++) {
        let rakam = parseInt(kod[i]);
        let deger = rakam + islemler[i];
        if (deger < 0) deger = -deger; // negatifse pozitif yap
        if (deger > 9) deger = deger % 10; // 10'dan büyükse sağ rakamı al
        sonuc += deger;
    }
    return sonuc;
}

// QR kod okuma
function onScanSuccess(decodedText, decodedResult) {
    // decodedText 6 haneli kod olmalı
    if(decodedText.length === 6 && /^\d{6}$/.test(decodedText)){
        const sifreli = sifrele(decodedText);
        document.getElementById("sifreliKod").innerText = sifreli;
    } else {
        document.getElementById("sifreliKod").innerText = "Geçersiz kod!";
    }
}

// HTML5 QR Kod okuyucu
var html5QrcodeScanner = new Html5QrcodeScanner(
    "reader", { fps: 10, qrbox: 250 });
html5QrcodeScanner.render(onScanSuccess);
</script>
</body>
</html>