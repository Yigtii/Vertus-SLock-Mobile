<!DOCTYPE html>
<html>
<head>
    <title>🔓 Vertus Kod Deşifre</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body { 
            font-family: Arial, sans-serif; 
            text-align: center; 
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        .container {
            background: rgba(255,255,255,0.1);
            padding: 30px;
            border-radius: 20px;
            backdrop-filter: blur(10px);
            max-width: 400px;
            margin: 0 auto;
        }
        .input-section, .output-section {
            margin: 20px 0;
        }
        input {
            font-size: 24px;
            padding: 15px;
            width: 200px;
            text-align: center;
            border: 2px solid rgba(255,255,255,0.3);
            border-radius: 10px;
            background: rgba(255,255,255,0.1);
            color: white;
            font-family: 'Courier New', monospace;
        }
        input::placeholder {
            color: rgba(255,255,255,0.6);
        }
        button {
            background: #2ecc71;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            margin: 10px;
        }
        button:hover {
            background: #27ae60;
        }
        .code { 
            font-size: 48px; 
            font-weight: bold; 
            color: #2ecc71; 
            margin: 20px 0;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            letter-spacing: 5px;
            font-family: 'Courier New', monospace;
            background: rgba(255,255,255,0.1);
            padding: 15px;
            border-radius: 10px;
        }
        .info {
            font-size: 14px;
            opacity: 0.8;
            margin: 10px 0;
        }
        .warning {
            background: rgba(255,0,0,0.3);
            padding: 10px;
            border-radius: 10px;
            margin: 15px 0;
        }
        .example {
            background: rgba(255,255,255,0.2);
            padding: 10px;
            border-radius: 8px;
            margin: 10px 0;
            font-size: 12px;
        }
        .auto-section {
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>🔓 Vertus Kod Deşifre</h1>
        
        <div class="warning">
            ⚠️ Ekrandaki kodu aşağıya gir, GERÇEK kodu al!
        </div>

        <!-- MANUEL GİRİŞ -->
        <div class="input-section">
            <h3>📝 Manuel Deşifre</h3>
            <input type="text" id="displayCode" placeholder="124021" maxlength="6" 
                   oninput="this.value = this.value.replace(/[^0-9]/g, '')">
            <br>
            <button onclick="decryptManual()">🔓 Kodu Deşifre Et</button>
        </div>

        <!-- OTOMATİK KOD -->
        <div class="auto-section">
            <h3>🔄 Otomatik Kod</h3>
            <div class="code" id="autoRealCode">--- ---</div>
            <div class="timer" id="timer"></div>
            <button onclick="copyAutoCode()">📋 Otomatik Kodu Kopyala</button>
        </div>

        <!-- ÇIKTI -->
        <div class="output-section">
            <h3>✅ Gerçek Kod</h3>
            <div class="code" id="realCode">--- ---</div>
            <button onclick="copyManualCode()">📋 Gerçek Kodu Kopyala</button>
        </div>

        <div class="example">
            <strong>Örnekler:</strong><br>
            • 124021 → <span style="color:#2ecc71">985978</span><br>
            • 567890 → <span style="color:#2ecc71">432109</span><br>
            • 111111 → <span style="color:#2ecc71">999999</span><br>
            • 000000 → <span style="color:#2ecc71">000000</span>
        </div>

        <div class="info">
            Ekrandaki 6 haneli kodu gir, gerçek kodu al ve akıllı tahtaya gir!
        </div>
    </div>

    <script>
        // Python'daki get_real_code fonksiyonunun birebir aynısı
        function getRealCode(displayCode) {
            let realCode = "";
            for (let i = 0; i < displayCode.length; i++) {
                const char = displayCode[i];
                if (char >= '0' && char <= '9') {
                    const digit = parseInt(char);
                    const realDigit = (10 - digit) % 10;
                    realCode += realDigit.toString();
                } else {
                    realCode += char;
                }
            }
            return realCode;
        }

        // Manuel deşifre işlemi
        function decryptManual() {
            const displayCode = document.getElementById('displayCode').value;
            
            if (displayCode.length !== 6) {
                alert('Lütfen 6 haneli kod girin!');
                return;
            }

            const realCode = getRealCode(displayCode);
            document.getElementById('realCode').textContent = realCode;
            
            // Debug
            console.log(`Girilen: ${displayCode} → Gerçek: ${realCode}`);
        }

        // Otomatik kod üretimi (mevcut sistemle uyumlu)
        function generateAutoCode() {
            const time = Math.floor(Date.now() / 30000);
            const secret = "vertus_okul_2024";
            const rawCode = secret + time;

            // Python'daki get_display_code mantığını taklit et
            function getDisplayCode() {
                // Basit hash fonksiyonu
                let hash = 0;
                for (let i = 0; i < rawCode.length; i++) {
                    hash = ((hash << 5) - hash) + rawCode.charCodeAt(i);
                    hash |= 0;
                }

                let numericCode = '';
                let hashStr = Math.abs(hash).toString();
                
                for (let i = 0; i < hashStr.length && numericCode.length < 6; i++) {
                    numericCode += hashStr[i];
                }

                while (numericCode.length < 6) {
                    numericCode += Math.floor(Math.random() * 10);
                }

                return numericCode.substr(0, 6);
            }

            const displayCode = getDisplayCode();
            const realCode = getRealCode(displayCode);
            
            document.getElementById('autoRealCode').textContent = realCode;

            // Geri sayım
            const secondsLeft = 30 - (Math.floor(Date.now() / 1000) % 30);
            document.getElementById('timer').textContent = 
                `Kod ${secondsLeft} saniye sonra değişecek`;
        }

        // Kopyalama fonksiyonları
        function copyManualCode() {
            const code = document.getElementById('realCode').textContent;
            if (code !== '--- ---') {
                navigator.clipboard.writeText(code).then(() => {
                    alert('Gerçek kod panoya kopyalandı: ' + code);
                });
            }
        }

        function copyAutoCode() {
            const code = document.getElementById('autoRealCode').textContent;
            if (code !== '--- ---') {
                navigator.clipboard.writeText(code).then(() => {
                    alert('Otomatik kod panoya kopyalandı: ' + code);
                });
            }
        }

        // Enter tuşu ile deşifre
        document.getElementById('displayCode').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                decryptManual();
            }
        });

        // Sayfa yüklendiğinde otomatik kodu başlat
        generateAutoCode();
        setInterval(generateAutoCode, 1000);

        // Input'a odaklan
        document.getElementById('displayCode').focus();
    </script>
</body>
</html>
